<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Elyjiah Potter" />

<meta name="date" content="2021-11-24" />

<title>DDS-Project-2</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Elyjiah Potter Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Main</a>
</li>
<li>
  <a href="Employee-Attrition-EDA.html">Employee Attrition Project</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">DDS-Project-2</h1>
<h4 class="author">Elyjiah Potter</h4>
<h4 class="date">11/24/2021</h4>

</div>


<div id="case-study-2-eda" class="section level1">
<h1>Case Study 2 EDA</h1>
<div id="import-data" class="section level2">
<h2>Import Data</h2>
<pre class="r"><code>data = read.csv(&#39;/Users/elyjiahpotter/Desktop/DDS-Project-2/CaseStudy2-data.csv&#39;)

head(data)</code></pre>
<pre><code>##   ID Age Attrition    BusinessTravel DailyRate             Department DistanceFromHome Education   EducationField EmployeeCount
## 1  1  32        No     Travel_Rarely       117                  Sales               13         4    Life Sciences             1
## 2  2  40        No     Travel_Rarely      1308 Research &amp; Development               14         3          Medical             1
## 3  3  35        No Travel_Frequently       200 Research &amp; Development               18         2    Life Sciences             1
## 4  4  32        No     Travel_Rarely       801                  Sales                1         4        Marketing             1
## 5  5  24        No Travel_Frequently       567 Research &amp; Development                2         1 Technical Degree             1
## 6  6  27        No Travel_Frequently       294 Research &amp; Development               10         2    Life Sciences             1
##   EmployeeNumber EnvironmentSatisfaction Gender HourlyRate JobInvolvement JobLevel                JobRole JobSatisfaction MaritalStatus
## 1            859                       2   Male         73              3        2        Sales Executive               4      Divorced
## 2           1128                       3   Male         44              2        5      Research Director               3        Single
## 3           1412                       3   Male         60              3        3 Manufacturing Director               4        Single
## 4           2016                       3 Female         48              3        3        Sales Executive               4       Married
## 5           1646                       1 Female         32              3        1     Research Scientist               4        Single
## 6            733                       4   Male         32              3        3 Manufacturing Director               1      Divorced
##   MonthlyIncome MonthlyRate NumCompaniesWorked Over18 OverTime PercentSalaryHike PerformanceRating RelationshipSatisfaction StandardHours
## 1          4403        9250                  2      Y       No                11                 3                        3            80
## 2         19626       17544                  1      Y       No                14                 3                        1            80
## 3          9362       19944                  2      Y       No                11                 3                        3            80
## 4         10422       24032                  1      Y       No                19                 3                        3            80
## 5          3760       17218                  1      Y      Yes                13                 3                        3            80
## 6          8793        4809                  1      Y       No                21                 4                        3            80
##   StockOptionLevel TotalWorkingYears TrainingTimesLastYear WorkLifeBalance YearsAtCompany YearsInCurrentRole YearsSinceLastPromotion
## 1                1                 8                     3               2              5                  2                       0
## 2                0                21                     2               4             20                  7                       4
## 3                0                10                     2               3              2                  2                       2
## 4                2                14                     3               3             14                 10                       5
## 5                0                 6                     2               3              6                  3                       1
## 6                2                 9                     4               2              9                  7                       1
##   YearsWithCurrManager
## 1                    3
## 2                    9
## 3                    2
## 4                    7
## 5                    3
## 6                    7</code></pre>
<p><br></p>
</div>
<div id="check-for-missing-values" class="section level2">
<h2>Check for missing values</h2>
<pre class="r"><code>gg_miss_var(data)</code></pre>
<pre><code>## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please use `guide = &quot;none&quot;` instead.</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="adjust-attrition-variable-for-modeling" class="section level2">
<h2>Adjust Attrition Variable for Modeling</h2>
<pre class="r"><code>data =data %&gt;%
  mutate(Attr = case_when( Attrition == &quot;Yes&quot; ~ 1,
                           Attrition == &quot;No&quot; ~ 0))</code></pre>
<p><br></p>
</div>
<div id="investigate-distributions-of-potentially-relevant-discrete-variablees" class="section level2">
<h2>Investigate Distributions of Potentially Relevant Discrete Variablees</h2>
<pre class="r"><code>data %&gt;% ggplot(aes(x = Age, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = DailyRate, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = DistanceFromHome, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = Education, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-4.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = EnvironmentSatisfaction, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-5.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = HourlyRate, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-6.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = JobInvolvement, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-7.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = JobLevel, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-8.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = JobSatisfaction, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-9.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = MonthlyIncome, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-10.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = MonthlyRate, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-11.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = NumCompaniesWorked, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-12.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = PercentSalaryHike, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-13.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = RelationshipSatisfaction, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-14.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = StockOptionLevel, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-15.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = TotalWorkingYears, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-16.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = TrainingTimesLastYear, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-17.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = WorkLifeBalance, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-18.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = YearsAtCompany, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-19.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = YearsInCurrentRole, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-20.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = YearsSinceLastPromotion, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-21.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = YearsWithCurrManager, fill = Attrition)) + geom_boxplot()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-4-22.png" width="672" /></p>
<p><br></p>
</div>
<div id="investigate-distributions-of-potentially-relevant-categorical-variables" class="section level2">
<h2>Investigate Distributions of Potentially Relevant Categorical Variables</h2>
<pre class="r"><code>data %&gt;% ggplot(aes(x = BusinessTravel, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = EducationField, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = Gender, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = MaritalStatus, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = Over18, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-5.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = JobRole, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-6.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = OverTime, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-7.png" width="672" /></p>
<pre class="r"><code>data %&gt;% ggplot(aes(x = Department, fill = Attrition)) + geom_histogram(stat = &quot;count&quot;) + facet_wrap(~Attrition)</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-5-8.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="age-breakdown" class="section level1">
<h1>Age Breakdown</h1>
<pre class="r"><code>#Aggregate Data
age_factor = cut(data$Age, breaks = c(13,19,29,39,49,59,69,79,89), labels = c(&quot;Teens&quot;, &quot;Twenties&quot;, &quot;Thirties&quot;, &quot;Forties&quot;, &quot;Fifties&quot;,&quot;Sixties&quot;,&quot;Seventies&quot;,&quot;Eighties&quot;))

data = data %&gt;%
  mutate(age_range = age_factor)

data %&gt;%
  group_by(age_range) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n()) </code></pre>
<pre><code>## # A tibble: 6 × 4
##   age_range attrition_count Count perc_attrition
##   &lt;fct&gt;               &lt;dbl&gt; &lt;int&gt;          &lt;dbl&gt;
## 1 Teens                   8    13         0.615 
## 2 Twenties               44   172         0.256 
## 3 Thirties               54   381         0.142 
## 4 Forties                21   215         0.0977
## 5 Fifties                13    86         0.151 
## 6 Sixties                 0     3         0</code></pre>
<pre class="r"><code># Plot Aggregated Data - Barplot
data %&gt;%
  group_by(age_range) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())  %&gt;%
  ggplot(aes(x = age_range, y = perc_attrition, fill = age_range)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;% Attrition by Age&quot;) +
  xlab(&quot;Age&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>data = data %&gt;% 
  mutate(age_order = case_when(
    grepl(&quot;Teens&quot;,age_range) ~ 1,
    grepl(&quot;Twenties&quot;,age_range) ~ 2,
    grepl(&quot;Thirties&quot;,age_range) ~ 3,
    grepl( &quot;Forties&quot;,age_range) ~ 4,
    grepl(&quot;Fifties&quot;,age_range) ~ 5,
    grepl(&quot;Sixties&quot;,age_range) ~ 6
  ))


# Scatterplot Comparison

data %&gt;%
  group_by(age_range, age_order) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())  %&gt;%
  ggplot(aes(x = age_order, y = perc_attrition)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  ggtitle(&quot;% Attrition by Age&quot;) +
  xlab(&quot;Age Rank&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;age_range&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<p><br></p>
<div id="satisfaction-score-creation" class="section level2">
<h2>Satisfaction Score Creation</h2>
<pre class="r"><code>data = data %&gt;%
  mutate(OverallSatisfaction = (JobSatisfaction+EnvironmentSatisfaction+WorkLifeBalance+RelationshipSatisfaction)/4)

data %&gt;%
  group_by(OverallSatisfaction) %&gt;%
   summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = OverallSatisfaction, perc_attrition)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  ylim(0,1)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 10 rows containing missing values (geom_smooth).</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="involvement-score-creation" class="section level1">
<h1>Involvement Score Creation</h1>
<pre class="r"><code>data = data %&gt;%
  mutate(Involvement = (JobInvolvement+TrainingTimesLastYear+StockOptionLevel)/3)

data %&gt;%
  group_by(Involvement) %&gt;%
  summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = Involvement, y = perc_attrition)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="percent-attrition-by-key-discrete-attributes" class="section level1">
<h1>Percent Attrition by key Discrete attributes</h1>
<pre class="r"><code># Years by perc attrition
data %&gt;%
  group_by(YearsAtCompany) %&gt;%
  summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = YearsAtCompany, y = perc_attrition)) +
  geom_point()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>data %&gt;%
  group_by(YearsAtCompany) %&gt;%
 summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = YearsAtCompany, y = perc_attrition)) +
  geom_point()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code># Distance by perc Attrition
data %&gt;%
  group_by(DistanceFromHome) %&gt;%
 summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = DistanceFromHome, y = perc_attrition)) +
  geom_point()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<pre class="r"><code># Total Working Years by Attrition
data %&gt;%
  group_by(TotalWorkingYears) %&gt;%
 summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = TotalWorkingYears, y = perc_attrition)) +
  geom_point()</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-9-4.png" width="672" /></p>
<p><br></p>
</div>
<div id="percent-attrition-by-key-categorical-attributes" class="section level1">
<h1>Percent Attrition by key Categorical attributes</h1>
<pre class="r"><code># Higher chance of attrition for teen males
data %&gt;%
  group_by(age_range, Gender) %&gt;%
  summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = age_range, y = Gender, fill = perc_attrition)) + 
  geom_tile()</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;age_range&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code># Higher chance of attrition for sales representatives
data %&gt;%
  group_by(Department, JobRole) %&gt;%
  summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = Department, y = JobRole, fill = perc_attrition)) + 
  geom_tile()</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Department&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code># Higher chance of attrition for single individuals with a technical degree
data %&gt;%
  group_by(MaritalStatus, EducationField) %&gt;%
  summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = MaritalStatus, y = EducationField, fill = perc_attrition)) + 
  geom_tile()</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;MaritalStatus&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<p><br></p>
<div id="education-field-attrition" class="section level2">
<h2>Education Field Attrition</h2>
<pre class="r"><code>#Aggregate Data

data %&gt;%
  group_by(EducationField) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n()) </code></pre>
<pre><code>## # A tibble: 6 × 4
##   EducationField   attrition_count Count perc_attrition
##   &lt;chr&gt;                      &lt;dbl&gt; &lt;int&gt;          &lt;dbl&gt;
## 1 Human Resources                4    15          0.267
## 2 Life Sciences                 53   358          0.148
## 3 Marketing                     20   100          0.2  
## 4 Medical                       37   270          0.137
## 5 Other                          9    52          0.173
## 6 Technical Degree              17    75          0.227</code></pre>
<pre class="r"><code># Plot Aggregated Data
data %&gt;%
  group_by(EducationField) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())  %&gt;%
  ggplot(aes(x = reorder(EducationField, perc_attrition), y = perc_attrition, fill = EducationField)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;% Attrition by Education Field&quot;) +
  xlab(&quot;Education Field&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="education-field-satisfaction" class="section level2">
<h2>Education Field Satisfaction</h2>
<pre class="r"><code>#Aggregate Data

data %&gt;%
  group_by(EducationField) %&gt;%
  summarize(Count = n(), avg_satisfaction = sum(JobSatisfaction)/n()) </code></pre>
<pre><code>## # A tibble: 6 × 3
##   EducationField   Count avg_satisfaction
##   &lt;chr&gt;            &lt;int&gt;            &lt;dbl&gt;
## 1 Human Resources     15             2.47
## 2 Life Sciences      358             2.74
## 3 Marketing          100             2.68
## 4 Medical            270             2.71
## 5 Other               52             2.75
## 6 Technical Degree    75             2.6</code></pre>
<pre class="r"><code># Plot Aggregated Data
data %&gt;%
  group_by(EducationField) %&gt;%
  summarize(Count = n(), avg_satisfaction = sum(JobSatisfaction)/n()) %&gt;%
  ggplot(aes(x = reorder(EducationField, avg_satisfaction), y = avg_satisfaction, fill = EducationField)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;Avg Satisfaction by Education Field&quot;) +
  xlab(&quot;Education Field&quot;) +
  ylab(&quot;Avg Satisfaction&quot;) +
  coord_cartesian(ylim=c(2.4,2.75)) +
  theme(legend.position = &quot;none&quot;) </code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="position-attrition" class="section level2">
<h2>Position Attrition</h2>
<pre class="r"><code>#Aggregate Data
data %&gt;%
  group_by(JobRole) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n()) </code></pre>
<pre><code>## # A tibble: 9 × 4
##   JobRole                   attrition_count Count perc_attrition
##   &lt;chr&gt;                               &lt;dbl&gt; &lt;int&gt;          &lt;dbl&gt;
## 1 Healthcare Representative               8    76         0.105 
## 2 Human Resources                         6    27         0.222 
## 3 Laboratory Technician                  30   153         0.196 
## 4 Manager                                 4    51         0.0784
## 5 Manufacturing Director                  2    87         0.0230
## 6 Research Director                       1    51         0.0196
## 7 Research Scientist                     32   172         0.186 
## 8 Sales Executive                        33   200         0.165 
## 9 Sales Representative                   24    53         0.453</code></pre>
<pre class="r"><code># Plot Aggregated Data

data %&gt;%
  group_by(JobRole) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())  %&gt;%
  ggplot(aes(x = reorder(JobRole, perc_attrition), y = perc_attrition, fill = JobRole)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;% Attrition by Position&quot;) +
  xlab(&quot;Position&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;) +
  theme(axis.text.x = element_text(angle = 50, 
                                   vjust = 1, 
                                   hjust = 1,
                                   size = 8))</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="position-avg-satisfaction" class="section level2">
<h2>Position Avg Satisfaction</h2>
<pre class="r"><code>#Aggregate Data
data %&gt;%
  group_by(JobRole) %&gt;%
  summarize(Count = n(),avg_satisfaction = sum(JobSatisfaction)/n()) </code></pre>
<pre><code>## # A tibble: 9 × 3
##   JobRole                   Count avg_satisfaction
##   &lt;chr&gt;                     &lt;int&gt;            &lt;dbl&gt;
## 1 Healthcare Representative    76             2.83
## 2 Human Resources              27             2.56
## 3 Laboratory Technician       153             2.69
## 4 Manager                      51             2.51
## 5 Manufacturing Director       87             2.72
## 6 Research Director            51             2.49
## 7 Research Scientist          172             2.80
## 8 Sales Executive             200             2.72
## 9 Sales Representative         53             2.70</code></pre>
<pre class="r"><code># Plot Aggregated Data

data %&gt;%
  group_by(JobRole) %&gt;%
  summarize(Count = n(),avg_satisfaction = sum(JobSatisfaction)/n())   %&gt;%
  ggplot(aes(x = reorder(JobRole,avg_satisfaction), y = avg_satisfaction, fill = JobRole)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;Avg Satisfaction by Position&quot;) +
  xlab(&quot;Position&quot;) +
  ylab(&quot;Avg Satisfaction&quot;) +
  theme(legend.position = &quot;none&quot;) +
  coord_cartesian(ylim=c(2.4,2.85)) +
  theme(axis.text.x = element_text(angle = 50, 
                                   vjust = 1, 
                                   hjust = 1,
                                   size = 8))</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="gender-age-attrition" class="section level2">
<h2>Gender / Age Attrition</h2>
<pre class="r"><code>#Aggregate Data
age_data = data %&gt;%
  group_by(Gender, age_range) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Gender&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>age_gender = data.frame(paste(age_data$Gender, age_data$age_range))
colnames(age_gender) = &quot;age_gender&quot;
age_data = cbind(age_data, age_gender)
age_data$age_gender = factor(age_data$age_gender)

age_data = age_data %&gt;% 
  mutate(order = case_when(
    grepl(&quot;Teens&quot;,age_range) ~ 1,
    grepl(&quot;Twenties&quot;,age_range) ~ 2,
    grepl(&quot;Thirties&quot;,age_range) ~ 3,
    grepl( &quot;Forties&quot;,age_range) ~ 4,
    grepl(&quot;Fifties&quot;,age_range) ~ 5,
    grepl(&quot;Sixties&quot;,age_range) ~ 6
  ))

# Plot Aggregated Data

age_data %&gt;%
  ggplot(aes(x = reorder(age_gender,order), y = perc_attrition, fill = Gender)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;% Attrition by Age and Gender&quot;) +
  xlab(&quot;Age / Gender&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;) +
  theme(axis.text.x = element_text(angle = 50, 
                                   vjust = 1, 
                                   hjust = 1,
                                   size = 8))</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="gender-age-avg-satisfaction" class="section level2">
<h2>Gender / Age Avg Satisfaction</h2>
<pre class="r"><code>#Aggregate Data
age_data = data %&gt;%
  group_by(Gender, age_range) %&gt;%
  summarize(Count = n(), avg_satisfaction = sum(JobSatisfaction)/n())</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Gender&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>age_gender = data.frame(paste(age_data$Gender, age_data$age_range))
colnames(age_gender) = &quot;age_gender&quot;
age_data = cbind(age_data, age_gender)
age_data$age_gender = factor(age_data$age_gender)

age_data = age_data %&gt;% 
  mutate(order = case_when(
    grepl(&quot;Teens&quot;,age_range) ~ 1,
    grepl(&quot;Twenties&quot;,age_range) ~ 2,
    grepl(&quot;Thirties&quot;,age_range) ~ 3,
    grepl( &quot;Forties&quot;,age_range) ~ 4,
    grepl(&quot;Fifties&quot;,age_range) ~ 5,
    grepl(&quot;Sixties&quot;,age_range) ~ 6
  ))

# Plot Aggregated Data

age_data %&gt;%
  ggplot(aes(x = reorder(age_gender,order), y = avg_satisfaction, fill = Gender)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;Avg Satisfaction by Age and Gender&quot;) +
  xlab(&quot;Age / Gender&quot;) +
  ylab(&quot;Avg Satisfaction&quot;) +
  theme(legend.position = &quot;none&quot;) +
  coord_cartesian(ylim=c(2.4,3.2)) +
  theme(axis.text.x = element_text(angle = 50, 
                                   vjust = 1, 
                                   hjust = 1,
                                   size = 8))</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="gender-age-marital-status-attrition" class="section level2">
<h2>Gender / Age / Marital Status Attrition</h2>
<pre class="r"><code>#Aggregate Data
age_data = data %&gt;%
  group_by(MaritalStatus, Gender, age_range) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;MaritalStatus&#39;, &#39;Gender&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>age_gender = data.frame(paste(age_data$Gender, age_data$MaritalStatus, age_data$age_range))
colnames(age_gender) = &quot;age_gender_marital&quot;
age_data = cbind(age_data, age_gender)
age_data$age_gender_marital = factor(age_data$age_gender_marital)

age_data = age_data %&gt;% 
  mutate(order = case_when(
    grepl(&quot;Teens&quot;,age_range) ~ 1,
    grepl(&quot;Twenties&quot;,age_range) ~ 2,
    grepl(&quot;Thirties&quot;,age_range) ~ 3,
    grepl( &quot;Forties&quot;,age_range) ~ 4,
    grepl(&quot;Fifties&quot;,age_range) ~ 5,
    grepl(&quot;Sixties&quot;,age_range) ~ 6
  ))

# Plot Aggregated Data

age_data %&gt;%
  ggplot(aes(x = reorder(age_gender_marital,order), y = perc_attrition, fill = Gender)) + 
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;% Attrition by Age, Gender, and Marital Status&quot;) +
  xlab(&quot;Age / Gender / Marital Status&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;) +
  theme(axis.text.x = element_text(angle = 50, 
                                   vjust = 1, 
                                   hjust = 1,
                                   size = 8))</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="investigating-relationship-betweeen-income-satisfaction-and-job-level" class="section level2">
<h2>Investigating Relationship betweeen Income, Satisfaction, and Job Level</h2>
<pre class="r"><code>roledata = data %&gt;%
  select(JobRole,JobLevel,OverallSatisfaction,TrainingTimesLastYear,MonthlyIncome) %&gt;%
  mutate(RoleLevel = paste(JobRole, &quot; Level: &quot;, JobLevel))

graph_roledata = roledata %&gt;%
  group_by(RoleLevel) %&gt;%
  summarize(AvgIncome = sum(MonthlyIncome)/n(), AvgTraining = sum(TrainingTimesLastYear)/n(), AvgSatisfaction = sum(OverallSatisfaction)/n()) 

graph_roledata %&gt;%
  ggplot(aes(x = RoleLevel, y = AvgIncome, fill = AvgSatisfaction)) +
  geom_bar(stat = &quot;identity&quot;) +
  theme(axis.text.x = element_text(angle = 90, 
                                   vjust = 1, 
                                   hjust = 1,
                                   size = 8)) +
  ggtitle(&quot;Monthly Income by Role / Level&quot;) +
  ylab(&quot;Avg Monthly Income&quot;) +
  xlab(&quot;Role / Level&quot;)</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code>graph_roledata %&gt;%
  ggplot(aes(x = reorder(RoleLevel, AvgSatisfaction), y = AvgSatisfaction)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;darkslategray3&quot;) +
  theme(axis.text.x = element_text(angle = 70, 
                                   vjust = 1, 
                                   hjust = 1,
                                   size = 8)) +
  ggtitle(&quot;Satisfaction by Role / Level&quot;) +
  ylab(&quot;Avg Satisfaction&quot;) +
  xlab(&quot;Role / Level&quot;)</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<p><br></p>
</div>
<div id="investigate-key-categorization-attributes" class="section level2">
<h2>Investigate Key Categorization Attributes</h2>
<div id="use-constant-value-over18-for-y-value-for-consistent-comparison" class="section level4">
<h4>Use constant value Over18 for y value for consistent comparison</h4>
<pre class="r"><code>for(i in 2:40)
{

 p = ggplot(data = data, mapping = aes(x = data[,i], y = Over18, color = Attr)) + geom_point(position = &quot;jitter&quot;) + xlab(colnames(data[i]))
 print(p)

}</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-1.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-2.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-3.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-4.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-5.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-6.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-7.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-8.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-9.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-10.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-11.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-12.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-13.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-14.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-15.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-16.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-17.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-18.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-19.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-20.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-21.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-22.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-23.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-24.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-25.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-26.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-27.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-28.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-29.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-30.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-31.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-32.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-33.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-34.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-35.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-36.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-37.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-38.png" width="672" /><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-19-39.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="clean-up-data-for-modeling" class="section level2">
<h2>Clean up data for modeling</h2>
<pre class="r"><code>data2 = select_if(data,is.numeric)
data2 = data2[,1:31]


data2_not = select(data,!is.numeric)
data2_not = data2_not[,2:9]

data2_not = data2_not %&gt;% 
  mutate(BusinessTravelRank = case_when(
    grepl(&quot;Non-Travel&quot;, BusinessTravel) ~ 0,
    grepl(&quot;Travel_Rarely&quot;, BusinessTravel) ~ 1,
    grepl(&quot;Travel_Frequently&quot;, BusinessTravel) ~ 3
  )) %&gt;%
  mutate(DepartmentRank = case_when(
    grepl(&quot;Research &amp; Development&quot;, Department) ~ 1,
    grepl(&quot;Human Resources&quot;, Department) ~ 2,
    grepl(&quot;Sales&quot;, Department) ~ 3
  )) %&gt;%
  mutate(EducationFieldRank = case_when(
    grepl(&quot;Life Sciences&quot;, EducationField) ~ 1,
    grepl(&quot;Medical&quot;, EducationField) ~ 2,
    grepl(&quot;Marketing&quot;, EducationField) ~ 3,
    grepl(&quot;Technical Degree&quot;, EducationField) ~ 4,
    grepl(&quot;Other&quot;, EducationField) ~ 5,
    grepl(&quot;Human Resources&quot;, EducationField) ~ 6
  )) %&gt;%
  mutate(GenderRank = case_when(
    grepl(&quot;Male&quot;, Gender) ~ 0,
    grepl(&quot;Female&quot;, Gender) ~ 1
  )) %&gt;%
  mutate(OvertimeRank = case_when(
    grepl(&quot;Yes&quot;, OverTime) ~ 0,
    grepl(&quot;No&quot;, OverTime) ~ 1
  ))

data2_not = select_if(data2_not,is.numeric)
  
data2 = cbind(data2,data2_not)

gg_miss_var(data2)</code></pre>
<pre><code>## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please use `guide = &quot;none&quot;` instead.</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="classification-knn" class="section level1">
<h1>Classification: KNN</h1>
<pre class="r"><code>splitPerc = 0.75
trainInices = sample(1:dim(data2)[1], round(splitPerc * dim(data2)[1]))

train = data2[trainInices,]
test = data2[-trainInices,]


# Create model info dataframe
model_info = data.frame(matrix(ncol = 3, nrow = 100000))
colnames(model_info) = c(&quot;Model&quot;, &quot;Sensitivity&quot;,&quot;Specificity&quot;)

tic = 1 # Ticker for loop

# Uncomment for k value loop
# for(l in 2:30)
#{
  for (i in 2:36)
  {
    for(j in i:36)
    {
      for(k in j:36)
      {
        classifications = knn(train[,c(i,j,k)], test[,c(i,j,k)], train$Attr, prob = TRUE, k = 11)
        table(classifications, test$Attr)
        x = confusionMatrix(table(classifications, test$Attr))
  
        # Comment for k valu eloop
        model_info$Model[tic]=(paste(&quot;Model for &quot;,colnames(data2[i]), &quot; and &quot;, colnames(data2[j]), &quot; and &quot;, colnames(data2[k])))
  
        # Uncomment for k value loop
        # model_info$Model[tic]=(paste(&quot;Model for &quot;,colnames(data2[i]), &quot; and &quot;, colnames(data2[j]), &quot; and &quot;, colnames(data2[k]), &quot; and k = &quot;, l))
  
        model_info$Sensitivity[tic] = x$byClass[1]
        model_info$Specificity[tic] = x$byClass[2]
  
        tic = tic + 1
      }
    }
  }
#} Uncomment for k value loop

output = model_info %&gt;% 
  filter(!grepl(&quot;Attr&quot;,Model)) %&gt;%
  arrange(-Specificity)

head(output)</code></pre>
<pre><code>##                                                                          Model Sensitivity Specificity
## 1     Model for  StockOptionLevel  and  OverallSatisfaction  and  OvertimeRank   0.9513514   0.3939394
## 2                   Model for  EmployeeCount  and  JobLevel  and  OvertimeRank   0.9243243   0.3636364
## 3 Model for  EnvironmentSatisfaction  and  StockOptionLevel  and  OvertimeRank   0.9567568   0.3636364
## 4                        Model for  JobLevel  and  JobLevel  and  OvertimeRank   0.9243243   0.3636364
## 5               Model for  JobLevel  and  PerformanceRating  and  OvertimeRank   0.9243243   0.3636364
## 6                   Model for  JobLevel  and  StandardHours  and  OvertimeRank   0.9243243   0.3636364</code></pre>
<p><br></p>
</div>
<div id="classification-naive-bayes" class="section level1">
<h1>Classification: Naive Bayes</h1>
<pre class="r"><code>bayes_model = naiveBayes(Attr~., data = data2)
predict(bayes_model, data2)</code></pre>
<pre><code>##   [1] 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 1 1 0 0 0 0 0 0 0 0 0 1 0 0 0 1 1 0
##  [67] 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0
## [133] 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
## [199] 0 1 0 0 0 1 0 1 1 1 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0
## [265] 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0
## [331] 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 1 0 0 0 1 0 0 0 1 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 1 0 0 0 1 0 0 0 0 0 1 0 1 0 0 0 1
## [397] 0 1 0 0 0 0 0 0 1 0 0 0 0 0 1 0 1 0 1 0 0 0 0 0 0 0 1 0 1 0 0 1 1 0 1 0 1 1 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0
## [463] 0 0 1 0 0 0 1 0 0 1 0 0 0 0 0 1 1 0 0 0 0 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0 0 1 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 1 0 0 0 0 1 0 0 0 0 0 1
## [529] 0 0 0 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 1 1 0 0 0 1 0 0 1 1 1 0
## [595] 0 0 0 0 1 1 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 1 1 0 1 0 0 0 0 1 1 0 0 0 0
## [661] 0 0 0 0 0 0 0 1 0 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 0 1 0 0 1 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0
## [727] 0 0 1 0 0 1 1 0 0 0 0 0 0 1 1 0 0 1 1 1 1 0 1 0 1 1 0 0 0 1 0 0 0 0 1 0 0 0 1 1 0 1 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0
## [793] 0 0 0 1 0 1 1 0 0 0 0 0 0 0 1 0 0 1 0 1 1 0 0 0 1 0 0 1 0 0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 0 1 0 0 0 1 0 0 0
## [859] 0 0 0 0 1 0 0 0 0 0 0 0
## Levels: 0 1</code></pre>
<pre class="r"><code>confusionMatrix(table(predict(bayes_model,data2), data2$Attr))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##    
##       0   1
##   0 639  53
##   1  91  87
##                                           
##                Accuracy : 0.8345          
##                  95% CI : (0.8081, 0.8586)
##     No Information Rate : 0.8391          
##     P-Value [Acc &gt; NIR] : 0.664134        
##                                           
##                   Kappa : 0.4477          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.002047        
##                                           
##             Sensitivity : 0.8753          
##             Specificity : 0.6214          
##          Pos Pred Value : 0.9234          
##          Neg Pred Value : 0.4888          
##              Prevalence : 0.8391          
##          Detection Rate : 0.7345          
##    Detection Prevalence : 0.7954          
##       Balanced Accuracy : 0.7484          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<pre class="r"><code># Note - while we initially worked to construct a knn model, the max specificity we could obtain was roughly 30%. Since this was below our 60% threshold, we moved forward with a probability based naive bayes model instead.</code></pre>
<p><br></p>
</div>
<div id="linear-regression-model-investigation-for-correlation" class="section level1">
<h1>Linear Regression Model Investigation for correlation</h1>
<pre class="r"><code>for(i in 2:36)
{

 p = ggplot(data = data2, mapping = aes(x = data2[,i], y = MonthlyIncome,)) + geom_point(position = &quot;jitter&quot;) + geom_smooth(method = &quot;lm&quot;) + xlab(colnames(data2[i]))
 print(p)

}</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-3.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-4.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-5.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-6.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-7.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-8.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-9.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-10.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-11.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-12.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-13.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-14.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-15.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-16.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-17.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-18.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-19.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-20.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-21.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-22.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-23.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-24.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-25.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-26.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-27.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-28.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-29.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-30.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-31.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-32.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-33.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-34.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-23-35.png" width="672" /> <br></p>
</div>
<div id="top-attributes" class="section level1">
<h1>Top Attributes:</h1>
<ul>
<li>Age</li>
<li>Education</li>
<li>Job Level</li>
<li>Total Working Years</li>
<li>Years at Company</li>
<li>Years in current role</li>
<li>Years since last promotion</li>
<li>Years with current manager</li>
</ul>
<div id="collinearity" class="section level2">
<h2>Collinearity</h2>
<ul>
<li>Job Level Total Working Years, Years at Company, Years in Current Role, Years since Last promotion, and Years with current manager are all likely correlated, so we will use the one with the strongest correlation with income: Job Level</li>
</ul>
</div>
</div>
<div id="linear-regression-model-with-top-3-correlating-attributes" class="section level1">
<h1>Linear Regression Model with Top 3 correlating attributes</h1>
<pre class="r"><code>fit = lm(MonthlyIncome ~ Age + JobLevel + Education , data = data2) 
summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ Age + JobLevel + Education, data = data2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5121.1  -950.7    68.5   740.9  3852.0 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -2310.409    223.920 -10.318  &lt; 2e-16 ***
## Age            19.041      6.193   3.075  0.00217 ** 
## JobLevel     3940.417     49.922  78.932  &lt; 2e-16 ***
## Education     -12.211     47.825  -0.255  0.79854    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1407 on 866 degrees of freedom
## Multiple R-squared:  0.9066, Adjusted R-squared:  0.9063 
## F-statistic:  2804 on 3 and 866 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>RSS = c(crossprod(fit$residuals))
MSE = RSS/length(fit$residuals)
RMSE = sqrt(MSE)
print(RMSE)</code></pre>
<pre><code>## [1] 1403.957</code></pre>
<p><br></p>
</div>
<div id="testing-other-regression-combinations" class="section level1">
<h1>Testing other regression combinations</h1>
<pre class="r"><code>model_df = data.frame(matrix(ncol = 6, nrow = 100000))
colnames(model_df) = c(&quot;Model&quot;, &quot;Intercept&quot;,&quot;First&quot;, &quot;Second&quot;, &quot;Third&quot;, &quot;RMSE&quot;)

tic = 0
  for (i in 2:36) 
  {
    for(j in i:36)
    {
      for(k in j:36)
      {
        
        fit = lm(MonthlyIncome ~ data2[,i] + data2[,j] + data2[,k] , data = data2) 
        x = summary(fit)
        RSS = c(crossprod(fit$residuals))
        MSE = RSS/length(fit$residuals)
        RMSE = sqrt(MSE)
        
        model_df$Model[tic] = paste(colnames(data2[i]), &quot; and &quot;, colnames(data2[j]), &quot; and &quot;, colnames(data2[k]))
        model_df$Intercept[tic] = x$coefficients[13]
        model_df$First[tic] = x$coefficients[14]
        model_df$Second[tic] = x$coefficients[15]
        model_df$Third[tic] = x$coefficients[16]
        model_df$RMSE[tic] = RMSE
        
        tic = tic + 1
      }
    }
  }

output = model_df %&gt;%
  filter(!grepl(&quot;MonthlyIncome&quot;, Model)) %&gt;%
  filter(!is.na(Intercept)) %&gt;%
  arrange(RMSE)

head(output)</code></pre>
<pre><code>##                                                            Model    Intercept         First        Second        Third     RMSE
## 1    JobLevel  and  TotalWorkingYears  and  YearsWithCurrManager 3.875726e-54 2.198417e-280  1.014850e-10 6.182710e-05 1374.498
## 2          JobLevel  and  TotalWorkingYears  and  DepartmentRank 8.112807e-31 5.599165e-278  1.695192e-06 1.011159e-04 1375.237
## 3          JobLevel  and  TotalWorkingYears  and  YearsAtCompany 1.028183e-59 1.245489e-279  2.636976e-10 1.578655e-03 1379.319
## 4      JobLevel  and  TotalWorkingYears  and  YearsInCurrentRole 6.344685e-56 2.816539e-279  6.816520e-10 2.514322e-03 1380.000
## 5        DistanceFromHome  and  JobLevel  and  TotalWorkingYears 2.183966e-44  1.055329e-02 7.578019e-279 4.793820e-08 1382.068
## 6 JobLevel  and  TotalWorkingYears  and  YearsSinceLastPromotion 1.781831e-61 1.595467e-277  9.082826e-09 8.836960e-02 1384.973</code></pre>
<p><br></p>
</div>
<div id="findings-joblevel-age_order-and-departmentrank-yield-the-lowest-rmse-from-the-attribute-set-combinataions-that-are-not-collinear" class="section level1">
<h1>Findings: JobLevel, age_order and DepartmentRank yield the lowest RMSE from the attribute set combinataions that are not collinear</h1>
</div>
<div id="final-linear-regression-model" class="section level1">
<h1>Final Linear Regression Model</h1>
<pre class="r"><code>lin_fit = lm(MonthlyIncome ~ JobLevel + age_order + DepartmentRank , data = data2) 
summary(lin_fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ JobLevel + age_order + DepartmentRank, 
##     data = data2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5279.4  -900.4    28.7   823.6  4131.7 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -1855.89     191.46  -9.693  &lt; 2e-16 ***
## JobLevel        3971.23      49.20  80.720  &lt; 2e-16 ***
## age_order        165.89      56.79   2.921  0.00358 ** 
## DepartmentRank  -232.00      51.71  -4.486 8.23e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1390 on 866 degrees of freedom
## Multiple R-squared:  0.9089, Adjusted R-squared:  0.9086 
## F-statistic:  2881 on 3 and 866 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>RSS = c(crossprod(lin_fit$residuals))
MSE = RSS/length(lin_fit$residuals)
RMSE = sqrt(MSE)
print(RMSE)</code></pre>
<pre><code>## [1] 1386.747</code></pre>
<p><br></p>
</div>
<div id="top-three-factors-for-attrition" class="section level1">
<h1>Top Three Factors for Attrition</h1>
<ul>
<li><p>Age</p></li>
<li><p>Involvement</p></li>
<li><p>Satisfaction Score</p></li>
</ul>
<p><br></p>
<div id="age-vs-attrition" class="section level2">
<h2>Age vs % Attrition</h2>
<pre class="r"><code>data %&gt;%
  group_by(age_range) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())  %&gt;%
  ggplot(aes(x = age_range, y = perc_attrition, fill = age_range)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(&quot;% Attrition by Age&quot;) +
  xlab(&quot;Age&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code>data %&gt;%
  group_by(age_range, age_order) %&gt;%
  summarize(attrition_count = sum(Attr), Count = n(), perc_attrition = sum(Attr)/n())  %&gt;%
  ggplot(aes(x = age_order, y = perc_attrition)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  ggtitle(&quot;% Attrition by Age&quot;) +
  xlab(&quot;Age Rank&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;age_range&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<p><br></p>
</div>
<div id="satisfaction-score-vs-attrition" class="section level2">
<h2>Satisfaction Score vs % Attrition</h2>
<pre class="r"><code>data = data %&gt;%
  mutate(OverallSatisfaction = (JobSatisfaction+EnvironmentSatisfaction+WorkLifeBalance+RelationshipSatisfaction)/4)

data %&gt;%
  group_by(OverallSatisfaction) %&gt;%
   summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = OverallSatisfaction, perc_attrition)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  ylim(0,1) + 
  ggtitle(&quot;% Attrition by Satisfaction Score&quot;) +
  xlab(&quot;Score&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 10 rows containing missing values (geom_smooth).</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="involvement-score-vs-attrition" class="section level1">
<h1>Involvement Score vs % Attrition</h1>
<pre class="r"><code>data = data %&gt;%
  mutate(Involvement = (JobInvolvement+TrainingTimesLastYear+StockOptionLevel)/3)

data %&gt;%
  group_by(Involvement) %&gt;%
  summarize(perc_attrition = sum(Attr)/n()) %&gt;%
  ggplot(aes(x = Involvement, y = perc_attrition)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;) +
  ggtitle(&quot;% Attrition by Involvement Score&quot;) +
  xlab(&quot;Score&quot;) +
  ylab(&quot;% Attrition&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="testing-naive-bayes-and-linear-regression-model" class="section level1">
<h1>Testing Naive Bayes and Linear Regression Model</h1>
<div id="import-and-transform-data" class="section level2">
<h2>Import and Transform Data</h2>
<pre class="r"><code>class = read.csv(&quot;/Users/elyjiahpotter/Desktop/CaseStudy2CompSet No Attrition.csv&quot;)
linear = read.csv(&quot;/Users/elyjiahpotter/Desktop/CaseStudy2CompSet No Salary.csv&quot;)

# Adjust to include an Attr column (dummy column to maintain dataset architecture)
class = class %&gt;%
  mutate(Attr = 0)

age_factor = cut(class$Age, breaks = c(13,19,29,39,49,59,69,79,89), labels = c(&quot;Teens&quot;, &quot;Twenties&quot;, &quot;Thirties&quot;, &quot;Forties&quot;, &quot;Fifties&quot;,&quot;Sixties&quot;,&quot;Seventies&quot;,&quot;Eighties&quot;))

class = class %&gt;%
  mutate(age_range = age_factor)

class = class %&gt;% 
  mutate(age_order = case_when(
    grepl(&quot;Teens&quot;,age_range) ~ 1,
    grepl(&quot;Twenties&quot;,age_range) ~ 2,
    grepl(&quot;Thirties&quot;,age_range) ~ 3,
    grepl( &quot;Forties&quot;,age_range) ~ 4,
    grepl(&quot;Fifties&quot;,age_range) ~ 5,
    grepl(&quot;Sixties&quot;,age_range) ~ 6
  ))

class = class %&gt;%
  mutate(OverallSatisfaction = (JobSatisfaction+EnvironmentSatisfaction+WorkLifeBalance+RelationshipSatisfaction)/4) %&gt;%
  mutate(Involvement = (JobInvolvement+TrainingTimesLastYear+StockOptionLevel)/3)

class2 = select_if(class,is.numeric)
class2 = class2[,1:31]

class2_not = select(class,!is.numeric)

class2_not = class2_not %&gt;% 
  mutate(BusinessTravelRank = case_when(
    grepl(&quot;Non-Travel&quot;, BusinessTravel) ~ 0,
    grepl(&quot;Travel_Rarely&quot;, BusinessTravel) ~ 1,
    grepl(&quot;Travel_Frequently&quot;, BusinessTravel) ~ 3
  )) %&gt;%
  mutate(DepartmentRank = case_when(
    grepl(&quot;Research &amp; Development&quot;, Department) ~ 1,
    grepl(&quot;Human Resources&quot;, Department) ~ 2,
    grepl(&quot;Sales&quot;, Department) ~ 3
  )) %&gt;%
  mutate(EducationFieldRank = case_when(
    grepl(&quot;Life Sciences&quot;, EducationField) ~ 1,
    grepl(&quot;Medical&quot;, EducationField) ~ 2,
    grepl(&quot;Marketing&quot;, EducationField) ~ 3,
    grepl(&quot;Technical Degree&quot;, EducationField) ~ 4,
    grepl(&quot;Other&quot;, EducationField) ~ 5,
    grepl(&quot;Human Resources&quot;, EducationField) ~ 6
  )) %&gt;%
  mutate(GenderRank = case_when(
    grepl(&quot;Male&quot;, Gender) ~ 0,
    grepl(&quot;Female&quot;, Gender) ~ 1
  )) %&gt;%
  mutate(OvertimeRank = case_when(
    grepl(&quot;Yes&quot;, OverTime) ~ 0,
    grepl(&quot;No&quot;, OverTime) ~ 1
  ))

class2_not = select_if(class2_not,is.numeric)
  
class2 = cbind(class2,class2_not)

gg_miss_var(class2)</code></pre>
<pre><code>## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please use `guide = &quot;none&quot;` instead.</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre class="r"><code>linear = linear %&gt;%
   mutate(Attr = case_when( Attrition == &quot;Yes&quot; ~ 1,
                           Attrition == &quot;No&quot; ~ 0))

age_factor = cut(linear$Age, breaks = c(13,19,29,39,49,59,69,79,89), labels = c(&quot;Teens&quot;, &quot;Twenties&quot;, &quot;Thirties&quot;, &quot;Forties&quot;, &quot;Fifties&quot;,&quot;Sixties&quot;,&quot;Seventies&quot;,&quot;Eighties&quot;))

linear = linear %&gt;%
  mutate(age_range = age_factor)

linear = linear %&gt;% 
  mutate(age_order = case_when(
    grepl(&quot;Teens&quot;,age_range) ~ 1,
    grepl(&quot;Twenties&quot;,age_range) ~ 2,
    grepl(&quot;Thirties&quot;,age_range) ~ 3,
    grepl( &quot;Forties&quot;,age_range) ~ 4,
    grepl(&quot;Fifties&quot;,age_range) ~ 5,
    grepl(&quot;Sixties&quot;,age_range) ~ 6
  ))

linear = linear %&gt;%
  mutate(OverallSatisfaction = (JobSatisfaction+EnvironmentSatisfaction+WorkLifeBalance+RelationshipSatisfaction)/4) %&gt;%
  mutate(Involvement = (JobInvolvement+TrainingTimesLastYear+StockOptionLevel)/3)

linear2 = select_if(linear,is.numeric)
linear2 = linear2[,1:30]

linear2_not = select(linear,!is.numeric)

linear2_not = linear2_not %&gt;% 
  mutate(BusinessTravelRank = case_when(
    grepl(&quot;Non-Travel&quot;, BusinessTravel) ~ 0,
    grepl(&quot;Travel_Rarely&quot;, BusinessTravel) ~ 1,
    grepl(&quot;Travel_Frequently&quot;, BusinessTravel) ~ 3
  )) %&gt;%
  mutate(DepartmentRank = case_when(
    grepl(&quot;Research &amp; Development&quot;, Department) ~ 1,
    grepl(&quot;Human Resources&quot;, Department) ~ 2,
    grepl(&quot;Sales&quot;, Department) ~ 3
  )) %&gt;%
  mutate(EducationFieldRank = case_when(
    grepl(&quot;Life Sciences&quot;, EducationField) ~ 1,
    grepl(&quot;Medical&quot;, EducationField) ~ 2,
    grepl(&quot;Marketing&quot;, EducationField) ~ 3,
    grepl(&quot;Technical Degree&quot;, EducationField) ~ 4,
    grepl(&quot;Other&quot;, EducationField) ~ 5,
    grepl(&quot;Human Resources&quot;, EducationField) ~ 6
  )) %&gt;%
  mutate(GenderRank = case_when(
    grepl(&quot;Male&quot;, Gender) ~ 0,
    grepl(&quot;Female&quot;, Gender) ~ 1
  )) %&gt;%
  mutate(OvertimeRank = case_when(
    grepl(&quot;Yes&quot;, OverTime) ~ 0,
    grepl(&quot;No&quot;, OverTime) ~ 1
  ))

linear2_not = select_if(linear2_not,is.numeric)
  
linear2 = cbind(linear2,linear2_not)

gg_miss_var(linear2)</code></pre>
<pre><code>## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please use `guide = &quot;none&quot;` instead.</code></pre>
<p><img src="Employee-Attrition-EDA_files/figure-html/unnamed-chunk-30-2.png" width="672" /></p>
</div>
<div id="test-classification-model" class="section level2">
<h2>Test Classification Model</h2>
<pre class="r"><code>predict(bayes_model, class2)</code></pre>
<pre><code>##   [1] 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 1 1 1 0 0 1 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1
##  [67] 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
## [133] 0 1 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 0 0 0 0 0 1 0 1 1 0 0 0 1 0 0 0 0 0 1 0 0 1 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 0
## [199] 0 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 1 1 0 1 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0
## [265] 0 0 0 0 1 0 1 1 0 1 1 0 1 0 1 0 1 0 0 0 1 1 1 1 1 1 0 0 1 0 1 0 0 1 0 0
## Levels: 0 1</code></pre>
<pre class="r"><code>results = data.frame(table(class2$ID,predict(bayes_model,class2)))

colnames(results) = c(&quot;ID&quot;, &quot;No Attrition&quot;, &quot;Attrition&quot;)

head(results)</code></pre>
<pre><code>##     ID No Attrition Attrition
## 1 1171            0         1
## 2 1172            0         1
## 3 1173            0         0
## 4 1174            0         1
## 5 1175            0         1
## 6 1176            0         1</code></pre>
<pre class="r"><code>write.csv(results, &quot;/Users/elyjiahpotter/Desktop/CaseStudy2_Classification_Results.csv&quot;)</code></pre>
</div>
<div id="test-linear-regression-model" class="section level2">
<h2>Test Linear Regression Model</h2>
<pre class="r"><code>testing_data = linear2 %&gt;%
  select(JobLevel, age_order, DepartmentRank)

results = data.frame(linear2$ID,predict(lin_fit, newdata = testing_data))

colnames(results) = c(&quot;ID&quot;, &quot;Predicted Monthly Salary&quot;)

head(results)</code></pre>
<pre><code>##    ID Predicted Monthly Salary
## 1 871                 6054.134
## 2 872                 2381.020
## 3 873                14162.485
## 4 874                 2381.020
## 5 875                 2215.125
## 6 876                 5888.239</code></pre>
<pre class="r"><code>write.csv(results, &quot;/Users/elyjiahpotter/Desktop/CaseStudy2_LinearRegression_Results.csv&quot;)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
